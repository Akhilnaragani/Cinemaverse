<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact Us - Cinemaverse</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Electrolize&display=swap');

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Electrolize', sans-serif;
      background:#000; color:#fff; margin:0;
    }

    /* NAV (slightly smaller as requested) */
    .navbar {
      display:flex; justify-content:center; align-items:center;
      padding:10px 20px; background:#000; position:sticky; top:0; z-index:1000;
    }
    .logo { font-size:1.6em; color:#f00; position:absolute; left:20px; }
    .menu-list { display:flex; list-style:none; padding:0; }
    .menu-list-item a {
      color:#fff; text-decoration:none; font-weight:bold;
      padding:8px 14px; font-size:0.95em; transition:color .3s ease;
    }
    .menu-list-item a:hover { color:#f00; }

    .footer {
      background:#000; color:#f00; text-align:center; padding:20px;
      position:relative; bottom:0; width:100%; font-size:16px; font-weight:bold;
    }

    .contact-container {
      display:flex; flex-direction:column; align-items:center; padding:50px 20px;
    }
    .contact-title { font-size:36px; color:#eb0000; margin-bottom:20px; }
    .contact-description {
      font-size:18px; text-align:center; max-width:600px; margin-bottom:40px;
    }
    .contact-form {
      display:flex; flex-direction:column; gap:20px; width:100%; max-width:500px;
    }
    .contact-form label { font-size:16px; }
    .contact-form input, .contact-form textarea {
      background:#000; color:#fff; border:2px solid #f30707;
      padding:10px; font-size:16px; border-radius:4px;
    }
    .contact-form input::placeholder, .contact-form textarea::placeholder { color:gray; }
    .contact-form input:focus, .contact-form textarea:focus { outline:0; border-color:#e20909; }
    .submit-button {
      background:#d30a0a; color:#fff; font-size:16px; font-weight:bold;
      border:0; border-radius:4px; padding:12px; cursor:pointer; transition:background-color .3s;
    }
    .submit-button:hover { background:#c83c3c; }
    #contact-status { min-height:20px; font-size:0.95em; }
  </style>

  <!-- Supabase lib + your auth helpers -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="auth.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Electrolize&display=swap">
</head>
<body>
  <!-- NAV -->
  <header class="navbar">
    <div class="logo">Cinemaverse</div>
    <ul class="menu-list">
      <li class="menu-list-item"><a href="index.html">Home</a></li>
      <li class="menu-list-item"><a href="movies.html">Movies</a></li>
      <li class="menu-list-item"><a href="series.html">Series</a></li>
      <li class="menu-list-item"><a href="watchlist.html">Watchlist</a></li>
      <li class="menu-list-item"><a href="gallery.html">Gallery</a></li>
      <li class="menu-list-item"><a href="contact.html">Contact Us</a></li>
      <li class="menu-list-item"><a href="about.html">About Us</a></li>
      
    </ul>
  </header>

  <!-- CONTACT -->
  <div class="contact-container">
    <h2 class="contact-title">Contact Us</h2>
    <p class="contact-description">
      Have questions or feedback? Reach out to us, and we’ll get back to you as soon as possible!
    </p>

    <form id="contact-form" class="contact-form">
      <label for="contact-name">Name</label>
      <input id="contact-name" name="name" type="text" placeholder="Your name" required />

      <label for="contact-email">Email</label>
      <input id="contact-email" name="email" type="email" placeholder="you@example.com" required />

      <label for="contact-message">Message</label>
      <textarea id="contact-message" name="message" rows="6" placeholder="How can we help?" required></textarea>

      <button type="submit" class="submit-button">Send</button>
      <p id="contact-status" aria-live="polite"></p>
    </form>
  </div>

  <script>
    // Use the Supabase client from auth.js if available; otherwise create a local client.
    (function initSupabaseClient() {
      // If a global 'supabase' client (with .auth) exists (from auth.js), use it.
      try {
        if (typeof supabase !== 'undefined' && supabase && supabase.auth) {
          window._sb = supabase;
          return;
        }
      } catch (e) {}

      // Fallback: create our own client with your same project keys
      if (window.supabase && window.supabase.createClient) {
        const SUPABASE_URL = "https://hvbeswqunsadayqghhzv.supabase.co";
        const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2YmVzd3F1bnNhZGF5cWdoaHp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NjQzNjcsImV4cCI6MjA3ODE0MDM2N30.rDvyGxFt8XO632S1Zw0ZANvYZaSsGgSb_pW49DXMMMg";
        window._sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      } else {
        alert("Supabase library failed to load.");
      }
    })();

    // Hook up the form
    const form = document.getElementById('contact-form');
    const nameEl = document.getElementById('contact-name');
    const emailEl = document.getElementById('contact-email');
    const messageEl = document.getElementById('contact-message');
    const statusEl = document.getElementById('contact-status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = "";

      const name = (nameEl.value || '').trim();
      const email = (emailEl.value || '').trim();
      const message = (messageEl.value || '').trim();

      // Basic validation
      if (!name || !email || !message) {
        statusEl.textContent = "Please fill in your name, email, and message.";
        return;
      }
      if (!/^\S+@\S+\.\S+$/.test(email)) {
        statusEl.textContent = "Please enter a valid email address.";
        return;
      }

      const btn = form.querySelector('button[type="submit"]');
      const oldText = btn.textContent;
      btn.disabled = true;
      btn.textContent = 'Sending…';

      try {
        // Optional: capture user id if logged in (won’t be inserted unless you add the column)
        let user_id = null;
        try {
          const sess = await window._sb.auth.getSession();
          user_id = sess?.data?.session?.user?.id || null;
        } catch {}

        // Insert ONLY existing columns to avoid schema errors.
        const payload = {
          name,
          email,
          message,
          created_at: new Date().toISOString()
        };

        const { error } = await window._sb
          .from('contact_messages')
          .insert([payload]);

        if (error) {
          console.error(error);
          statusEl.textContent = "Sorry, something went wrong. Please try again.";
          alert("Sorry, something went wrong. Please try again.");
        } else {
          statusEl.textContent = "Message sent! We’ll get back to you soon ✅";
          form.reset();
        }
      } catch (err) {
        console.error(err);
        statusEl.textContent = "Sorry, something went wrong. Please try again.";
        alert("Sorry, something went wrong. Please try again.");
      } finally {
        btn.disabled = false;
        btn.textContent = oldText;
      }
    });

    // Optional: show correct Login/Logout buttons using your auth helpers
    if (typeof updateAuthUI === 'function') {
      updateAuthUI();
    }
  </script>

  <footer class="footer">
    <p><strong>&copy; 2023 Cinemaverse. All rights reserved. All content is the property of their respective owners.
      Unauthorized use is prohibited.</strong></p>
  </footer>
</body>
</html>
